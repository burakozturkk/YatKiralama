@model YatKiralama.Models.Yat

@using Microsoft.AspNetCore.Http;
@{
    ViewData["Title"] = Model.Name;
}


<!-- breadcrumb -->
<div class="container">
    <div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
        <a href="index.html" class="stext-109 cl8 hov-cl1 trans-04">
            Ana Sayfa
            <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
        </a>

        <a href="product.html" class="stext-109 cl8 hov-cl1 trans-04">
            Yatlar
            <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
        </a>

        <span class="stext-109 cl4">
            @Model.Name
        </span>
    </div>
</div>


<!-- Product Detail -->
<section class="sec-product-detail bg0 p-t-65 p-b-60">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-lg-7 p-b-30">
                <div class="p-l-25 p-r-30 p-lr-0-lg">
                    <div class="wrap-slick3 flex-sb flex-w">
                        <div class="wrap-slick3-dots"></div>
                        <div class="wrap-slick3-arrows flex-sb-m flex-w"></div>

                        <div class="slick3 gallery-lb">
                            <div class="item-slick3" data-thumb="/@Model.ImgLocation">
                                <div class="wrap-pic-w pos-relative">
                                    <img src="/@Model.ImgLocation" alt="IMG-PRODUCT">

                                    <a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="/@Model.ImgLocation">
                                        <i class="fa fa-expand"></i>
                                    </a>
                                </div>
                            </div>

                            <div class="item-slick3" data-thumb="/@Model.ImgLocation2">
                                <div class="wrap-pic-w pos-relative">
                                    <img src="/@Model.ImgLocation2" alt="IMG-PRODUCT">

                                    <a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="/@Model.ImgLocation2">
                                        <i class="fa fa-expand"></i>
                                    </a>
                                </div>
                            </div>

                            <div class="item-slick3" data-thumb="/@Model.ImgLocation3">
                                <div class="wrap-pic-w pos-relative">
                                    <img src="/@Model.ImgLocation3" alt="IMG-PRODUCT">

                                    <a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04" href="/@Model.ImgLocation3">
                                        <i class="fa fa-expand"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-5 p-b-30">
                <div class="p-r-50 p-t-5 p-lr-0-lg">
                    <h4 class="mtext-105 cl2 js-name-detail p-b-14">
                        @Model.Name
                    </h4>
                    <p id="yatid" style="display:none">@Model.Id</p>
                    <span class="mtext-106 cl2">
                        @Model.Price <a>₺</a>
                    </span>

                    <p class="stext-102 cl3 p-t-23">
                        @Model.Details
                    </p>
                    @using (Html.BeginForm("Kirala", "Yatlar", FormMethod.Post))
                    {
                        <input name="UserID" style="display:none;" value="@Context.Session.GetString("ID")" />
                        <input name="YatID" style="display:none;" value="@Model.Id" />
                        <div class="p-t-33">
                            <div class="flex-w flex-r-m p-b-10">
                                <div class="size-203 flex-c-m respon6">
                                    Tarih
                                </div>

                                <div class="size-204 respon6-next">
                                    <div class="rs1-select2 bor8 bg0">
                                        <select class="js-select2" id="date" name="Tarih" onchange="SelectedIndexChanged()" required>
                                            <option selected disabled value="">Tarih Seçiniz</option>
                                            @for (int day = 0; day < 30; day++)
                                            {
                                                <option value="@String.Format("{0:MM/dd/yyyy}", @DateTime.Today.AddDays(day))">@String.Format("{0:dd/MM/yyyy}", @DateTime.Today.AddDays(day)) </option>
                                            }
                                        </select>

                                        <div class="dropDownSelect2"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-w flex-r-m p-b-10" style="margin-bottom:10px">
                                <div class="size-203 flex-c-m respon6">
                                    Saat
                                </div>

                                <div class="size-204 respon6-next">
                                    <div class="rs1-select2 bor8 bg0">
                                        <select class="js-select2" id="saat" name="SaatID">
                                            <option selected disabled>Saat Seçiniz</option>

                                        </select>
                                        <div class="dropDownSelect2"></div>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <h3 style="margin-top:10px;margin-bottom:10px">Ödeme Bilgileri</h3>
                            <div class="flex-w flex-r-m p-b-10">
                                <div class="size-203 flex-c-m respon6">
                                    Ad ve Soyad
                                </div>

                                <div class="size-204 respon6-next">
                                    <div class="rs1-select2 bor8 bg0">
                                        <input class="form-control" type="text" name="adsoyad" required />
                                    </div>
                                </div>
                            </div>

                            <div class="flex-w flex-r-m p-b-10">
                                <div class="size-203 flex-c-m respon6">
                                    Kart Numarası
                                </div>

                                <div class="size-204 respon6-next">
                                    <div class="rs1-select2 bor8 bg0">
                                        <input pattern=".{19,}" title="Lütfen Doğru bir şekilde doldurunuz." class="form-control" type="text" name="kartno" id="kartnumarasi" min="19" required />
                                    </div>
                                </div>
                            </div>

                            <div class="flex-w flex-r-m p-b-10">
                                <div class="size-203 flex-c-m respon6">
                                    CVC
                                </div>

                                <div class="size-204 respon6-next">
                                    <div class="rs1-select2 bor8 bg0">
                                        <input pattern=".{3,}" title="Lütfen Doğru bir şekilde doldurunuz." class="form-control" type="text" name="cvc" id="cvc" required />


                                    </div>
                                </div>
                            </div>
                            <div class="flex-w flex-r-m p-b-10">
                                <div class="size-204 flex-w flex-m respon6-next">
                                    @if (Context.Session.GetString("ID") != null)
                                    {
                                        <button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail" id="kirala" style="margin-top: 20px;margin-left:50px;">
                                            Hemen Kirala
                                        </button>
                                    }
                                    @if (Context.Session.GetString("ID") == null)
                                    {
                                        <a href="/Hesabim/Giris" class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail" id="kirala" style="margin-top: 20px;margin-left:50px;">
                                            Hemen Kirala
                                        </a>
                                    }

                                </div>
                            </div>
                        </div>

                    }

                </div>
            </div>
        </div>

        <div class="bor10 m-t-50 p-t-43 p-b-40">
            <!-- Tab01 -->
            <div class="tab01">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item p-b-10">
                        <a class="nav-link active" data-toggle="tab" href="#description" role="tab">Açıklama</a>
                    </li>

                    <li class="nav-item p-b-10">
                        <a class="nav-link" data-toggle="tab" href="#information" role="tab">Ek Bilgiler</a>
                    </li>

                    <li class="nav-item p-b-10">
                        <a class="nav-link" data-toggle="tab" href="#reviews" role="tab">Yorumlar</a>
                    </li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content p-t-43">
                    <!-- - -->
                    <div class="tab-pane fade show active" id="description" role="tabpanel">
                        <div class="how-pos2 p-lr-15-md">
                            <p class="stext-102 cl6">
                              
                            </p>
                        </div>
                    </div>

                    <!-- - -->
                    <div class="tab-pane fade" id="information" role="tabpanel">
                        <div class="row">
                            <div class="col-sm-10 col-md-8 col-lg-6 m-lr-auto">
                                <ul class="p-lr-28 p-lr-15-sm">
                                    <li class="flex-w flex-t p-b-7">
                                        <span class="stext-102 cl3 size-205">
                                            Uzunluk
                                        </span>

                                        <span class="stext-102 cl6 size-206">
                                            @Model.Length mt
                                        </span>
                                    </li>

                                    <li class="flex-w flex-t p-b-7">
                                        <span class="stext-102 cl3 size-205">
                                            Kapasite
                                        </span>

                                        <span class="stext-102 cl6 size-206">
                                            @Model.Capacity Kişilik
                                        </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- - -->
                    <div class="tab-pane fade" id="reviews" role="tabpanel">
                        <div class="row">
                            <div class="col-sm-10 col-md-8 col-lg-6 m-lr-auto">
                                <div class="p-b-30 m-lr-15-sm" >
                                    <!-- Review -->
                                    <div id="yorumbody">
                                        <div class="flex-w flex-t p-b-68">
                                            <div class="size-207">
                                                <div class="flex-w flex-sb-m p-b-17">
                                                    <span class="mtext-107 cl2 p-r-20">
                                                        Ariana Grande
                                                    </span>
                                                </div>
                                                <p class="stext-102 cl6">
                                                    descriptoio
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                   
                                    @if (@Context.Session.GetString("ID") == null)
                                    {
                                        <h5 class="mtext-108 cl2 p-b-7 mb-2">
                                            Yorum Yapmak İçin Giriş Yapınız.
                                        </h5>
                                        <a href="/Hesabim/Giris" class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail" id="kirala" style="margin-top: 20px;margin-left:50px;">
                                            Giriş Yap
                                        </a>
                                    }
                                    @if (@Context.Session.GetString("ID") != null)
                                    {
                                        <!-- Add review -->
                                        @using (Html.BeginForm("YorumYap", "Yatlar", FormMethod.Post))
                                        {
                                            <h5 class="mtext-108 cl2 p-b-7 mb-2">
                                                Bir Yorum Ekleyin.
                                            </h5>
                                            <input name="UserID" style="display:none;" value="@Context.Session.GetString("ID")" />
                                            <input name="YatId" style="display:none;" value="@Model.Id" />
                                            <input name="CreatedDate" style="display:none;" value="@String.Format("{0:MM/dd/yyyy}", @DateTime.Today)" />
                                            <div class="row p-b-25">
                                                <div class="col-12 p-b-5">
                                                    <label class="stext-102 cl3" for="yorum">Yorumunuz</label>
                                                    <textarea class="size-110 bor8 stext-102 cl2 p-lr-20 p-tb-10" id="yorum" name="Detail"></textarea>
                                                </div>

                                                <div class="col-sm-6 p-b-5">
                                                    <label class="stext-102 cl3" for="name">İsim</label>
                                                    <input class="size-111 bor8 stext-102 cl2 p-lr-20" id="name" type="text" name="Name">
                                                </div>

                                            </div>

                                            <button class="flex-c-m stext-101 cl0 size-112 bg7 bor11 hov-btn3 p-lr-15 trans-04 m-b-10">
                                                Gönder
                                            </button>
                                        }
                                    }

                                    <p class="text-center" style="color:red">@ViewBag.error2</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.4/jquery.inputmask.bundle.js"></script>

<script>

    $("#kartnumarasi").inputmask({
        mask: "9999 9999 9999 9999",
        placeholder: ""
    });
    $("#cvc").inputmask({
        mask: "999",
        placeholder: ""
    });


    $('#yatlar').addClass('active-menu');

    function SelectedIndexChanged() {
        var date = $('#date').val();
        var yatid = document.getElementById("yatid").innerHTML;
        console.log(date);
        date = date.replace('/', '.');
        date = date.replace('/', '.');
        console.log(date);
        var selectsaat = $("#saat");
        selectsaat.html("");
        $.ajax({
            type: "GET",
            url: '/api/DatePickerController/' + yatid + '/' + date,
            contentType: "application/json",
            dataType: "json",
            success: function (data) {
                if (!data[0].HasError) {
                    console.log(data);
                    selectsaat.html("");
                    $.each(data, function (i, o) {
                        selectsaat.append($("<option value=" + o.id + ">" + o.saat + "</option>"));
                    });

                }
                else {
                }
            },
            error: function (xhr, status, error) {
                var err = eval("(" + xhr.responseText + ")");
                $.toast({ heading: 'Error!', text: err.Message, position: 'top-right', loaderBg: '#ff6849', icon: 'error', hideAfter: 3500, stack: 6 });
            }
        });

    }

    var yatid2 = document.getElementById("yatid").innerHTML;
    $(document).ready(function() {
    var selectyorum = $("#yorumbody");
        selectyorum.html("");
        $.ajax({
            type: "GET",
            url: '/api/CommentsController/' + yatid2,
            contentType: "application/json",
            dataType: "json",
            success: function (data) {
                if (!data[0].HasError) {
                    console.log(data);
                    selectyorum.html("");
                    $.each(data, function (i, o) {
                        selectyorum.append($('<div class="flex-w flex-t p-b-68">'+
                                            '<div class="size-207">'+
                                                '<div class="flex-w flex-sb-m p-b-17">'+
                                                    '<span class="mtext-107 cl2 p-r-20">'+o.detail+'</span></div>'+
                            '<p class="stext-102 cl6">'+o.name+'</p></div></div>'
                        ));
                    });

                }
                else {
                }
            },
            error: function (xhr, status, error) {
                var err = eval("(" + xhr.responseText + ")");
                $.toast({ heading: 'Error!', text: err.Message, position: 'top-right', loaderBg: '#ff6849', icon: 'error', hideAfter: 3500, stack: 6 });
            }
        });
    });

</script>